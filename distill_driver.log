
[1/18] Running distillation: epoch=70,, temp=0.3, alpha=0.5
Saving to: model/forget_model/mixed_distill_epoch70,_temp0.3_forgetAlpha0.5
usage: mixed_distill.py [-h] [--temperature TEMPERATURE]
                        [--forget_loss_alpha FORGET_LOSS_ALPHA]
                        [--epochs EPOCHS] --output_dir OUTPUT_DIR
mixed_distill.py: error: argument --epochs: invalid int value: '70,'
Running evaluation on model/forget_model/mixed_distill_epoch70,_temp0.3_forgetAlpha0.5
Ambiguous value for argument 'model_path=model/forget_model/mixed_distill_epoch70,_temp0.3_forgetAlpha0.5'
1. To use it as a list, use key=[value1,value2]
2. To use it as string, quote the value: key=\'value1,value2\'
3. To sweep over it, add --multirun to your command line

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Done with 1/18: model/forget_model/mixed_distill_epoch70,_temp0.3_forgetAlpha0.5
--------------------------------------------------

[2/18] Running distillation: epoch=100,, temp=0.3, alpha=0.5
Saving to: model/forget_model/mixed_distill_epoch100,_temp0.3_forgetAlpha0.5
usage: mixed_distill.py [-h] [--temperature TEMPERATURE]
                        [--forget_loss_alpha FORGET_LOSS_ALPHA]
                        [--epochs EPOCHS] --output_dir OUTPUT_DIR
mixed_distill.py: error: argument --epochs: invalid int value: '100,'
Running evaluation on model/forget_model/mixed_distill_epoch100,_temp0.3_forgetAlpha0.5
Ambiguous value for argument 'model_path=model/forget_model/mixed_distill_epoch100,_temp0.3_forgetAlpha0.5'
1. To use it as a list, use key=[value1,value2]
2. To use it as string, quote the value: key=\'value1,value2\'
3. To sweep over it, add --multirun to your command line

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Done with 2/18: model/forget_model/mixed_distill_epoch100,_temp0.3_forgetAlpha0.5
--------------------------------------------------

[3/18] Running distillation: epoch=150, temp=0.3, alpha=0.5
Saving to: model/forget_model/mixed_distill_epoch150_temp0.3_forgetAlpha0.5
The model was loaded with use_flash_attention_2=True, which is deprecated and may be removed in a future release. Please use `attn_implementation="flash_attention_2"` instead.
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 1/3 [01:09<02:18, 69.23s/it]Loading checkpoint shards:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [01:56<00:56, 56.10s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [02:30<00:00, 46.10s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [02:30<00:00, 50.11s/it]
/student/tahmad8/anaconda3/envs/tofu39/lib/python3.9/site-packages/transformers/training_args.py:1576: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
[2025-04-07 01:14:25,811] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Warning: The cache directory for DeepSpeed Triton autotune, /student/tahmad8/.triton/autotune, appears to be on an NFS system. While this is generally acceptable, if you experience slowdowns or hanging when DeepSpeed exits, it is recommended to set the TRITON_CACHE_DIR environment variable to a non-NFS path.
  0%|          | 0/150 [00:00<?, ?it/s]  1%|          | 1/150 [00:08<21:40,  8.73s/it]  1%|â–         | 2/150 [00:09<10:05,  4.09s/it]  2%|â–         | 3/150 [00:10<06:15,  2.56s/it]  3%|â–Ž         | 4/150 [00:10<04:25,  1.82s/it]  3%|â–Ž         | 5/150 [00:11<03:24,  1.41s/it]                                                 3%|â–Ž         | 5/150 [00:11<03:24,  1.41s/it]  4%|â–         | 6/150 [00:12<02:51,  1.19s/it]  5%|â–         | 7/150 [00:13<02:30,  1.05s/it]  5%|â–Œ         | 8/150 [00:13<02:16,  1.04it/s]  6%|â–Œ         | 9/150 [00:14<02:07,  1.11it/s]  7%|â–‹         | 10/150 [00:15<02:03,  1.13it/s]                                                  7%|â–‹         | 10/150 [00:15<02:03,  1.13it/s]  7%|â–‹         | 11/150 [00:16<02:00,  1.15it/s]  8%|â–Š         | 12/150 [00:17<01:57,  1.18it/s]  9%|â–Š         | 13/150 [00:18<01:54,  1.19it/s]  9%|â–‰         | 14/150 [00:18<01:52,  1.20it/s] 10%|â–ˆ         | 15/150 [00:19<01:50,  1.22it/s]                                                 10%|â–ˆ         | 15/150 [00:19<01:50,  1.22it/s] 11%|â–ˆ         | 16/150 [00:20<01:49,  1.22it/s] 11%|â–ˆâ–        | 17/150 [00:21<01:48,  1.23it/s] 12%|â–ˆâ–        | 18/150 [00:22<01:46,  1.23it/s] 13%|â–ˆâ–Ž        | 19/150 [00:22<01:46,  1.23it/s] 13%|â–ˆâ–Ž        | 20/150 [00:23<01:45,  1.23it/s]                                                 13%|â–ˆâ–Ž        | 20/150 [00:23<01:45,  1.23it/s] 14%|â–ˆâ–        | 21/150 [00:24<01:44,  1.23it/s] 15%|â–ˆâ–        | 22/150 [00:25<01:44,  1.23it/s] 15%|â–ˆâ–Œ        | 23/150 [00:26<01:42,  1.23it/s] 16%|â–ˆâ–Œ        | 24/150 [00:26<01:42,  1.23it/s] 17%|â–ˆâ–‹        | 25/150 [00:27<01:41,  1.24it/s]                                                 17%|â–ˆâ–‹        | 25/150 [00:27<01:41,  1.24it/s] 17%|â–ˆâ–‹        | 26/150 [00:28<01:40,  1.24it/s] 18%|â–ˆâ–Š        | 27/150 [00:29<01:39,  1.24it/s] 19%|â–ˆâ–Š        | 28/150 [00:30<01:38,  1.24it/s] 19%|â–ˆâ–‰        | 29/150 [00:30<01:37,  1.24it/s] 20%|â–ˆâ–ˆ        | 30/150 [00:31<01:36,  1.24it/s]                                                 20%|â–ˆâ–ˆ        | 30/150 [00:31<01:36,  1.24it/s] 21%|â–ˆâ–ˆ        | 31/150 [00:32<01:35,  1.24it/s] 21%|â–ˆâ–ˆâ–       | 32/150 [00:33<01:35,  1.24it/s] 22%|â–ˆâ–ˆâ–       | 33/150 [00:34<01:34,  1.24it/s] 23%|â–ˆâ–ˆâ–Ž       | 34/150 [00:35<01:36,  1.21it/s] 23%|â–ˆâ–ˆâ–Ž       | 35/150 [00:35<01:36,  1.19it/s]                                                 23%|â–ˆâ–ˆâ–Ž       | 35/150 [00:35<01:36,  1.19it/s] 24%|â–ˆâ–ˆâ–       | 36/150 [00:36<01:37,  1.17it/s] 25%|â–ˆâ–ˆâ–       | 37/150 [00:37<01:34,  1.20it/s] 25%|â–ˆâ–ˆâ–Œ       | 38/150 [00:38<01:30,  1.23it/s] 26%|â–ˆâ–ˆâ–Œ       | 39/150 [00:39<01:28,  1.25it/s] 27%|â–ˆâ–ˆâ–‹       | 40/150 [00:39<01:25,  1.28it/s]                                                 27%|â–ˆâ–ˆâ–‹       | 40/150 [00:39<01:25,  1.28it/s] 27%|â–ˆâ–ˆâ–‹       | 41/150 [00:40<01:22,  1.32it/s] 28%|â–ˆâ–ˆâ–Š       | 42/150 [00:41<01:19,  1.36it/s] 29%|â–ˆâ–ˆâ–Š       | 43/150 [00:41<01:17,  1.39it/s] 29%|â–ˆâ–ˆâ–‰       | 44/150 [00:42<01:15,  1.40it/s] 30%|â–ˆâ–ˆâ–ˆ       | 45/150 [00:43<01:14,  1.42it/s]                                                 30%|â–ˆâ–ˆâ–ˆ       | 45/150 [00:43<01:14,  1.42it/s] 31%|â–ˆâ–ˆâ–ˆ       | 46/150 [00:44<01:12,  1.43it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 47/150 [00:44<01:11,  1.43it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 48/150 [00:45<01:11,  1.44it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 49/150 [00:46<01:10,  1.44it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 50/150 [00:46<01:09,  1.44it/s]                                                 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 50/150 [00:46<01:09,  1.44it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 51/150 [00:50<02:50,  1.72s/it] 35%|â–ˆâ–ˆâ–ˆâ–      | 52/150 [00:51<02:20,  1.44s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 53/150 [00:52<01:59,  1.24s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 54/150 [00:53<01:45,  1.10s/it] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 55/150 [00:53<01:34,  1.00it/s]                                                 37%|â–ˆâ–ˆâ–ˆâ–‹      | 55/150 [00:53<01:34,  1.00it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 56/150 [00:54<01:27,  1.08it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 57/150 [00:55<01:21,  1.14it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 58/150 [00:56<01:17,  1.18it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 59/150 [00:57<01:14,  1.21it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 60/150 [00:57<01:12,  1.24it/s]                                                 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 60/150 [00:57<01:12,  1.24it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 61/150 [00:58<01:10,  1.26it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 62/150 [00:59<01:09,  1.27it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 63/150 [01:00<01:07,  1.28it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 64/150 [01:00<01:06,  1.29it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 65/150 [01:01<01:05,  1.29it/s]                                                 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 65/150 [01:01<01:05,  1.29it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 66/150 [01:02<01:04,  1.30it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 67/150 [01:03<01:04,  1.30it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 68/150 [01:03<01:03,  1.30it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 69/150 [01:04<01:02,  1.30it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 70/150 [01:05<01:01,  1.30it/s]                                                 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 70/150 [01:05<01:01,  1.30it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 71/150 [01:06<01:00,  1.30it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 72/150 [01:07<00:59,  1.30it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 73/150 [01:07<00:58,  1.31it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 74/150 [01:08<00:58,  1.31it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 75/150 [01:09<00:57,  1.30it/s]                                                 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 75/150 [01:09<00:57,  1.30it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 76/150 [01:10<00:56,  1.30it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 77/150 [01:10<00:55,  1.30it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 78/150 [01:11<00:55,  1.31it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 79/150 [01:12<00:54,  1.31it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 80/150 [01:13<00:53,  1.30it/s]                                                 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 80/150 [01:13<00:53,  1.30it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 81/150 [01:13<00:52,  1.30it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 82/150 [01:14<00:52,  1.30it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 83/150 [01:15<00:51,  1.30it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 84/150 [01:16<00:50,  1.30it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 85/150 [01:16<00:49,  1.30it/s]                                                 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 85/150 [01:16<00:49,  1.30it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 86/150 [01:17<00:49,  1.30it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 87/150 [01:18<00:49,  1.27it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 88/150 [01:19<00:48,  1.28it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 89/150 [01:20<00:47,  1.29it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 90/150 [01:20<00:46,  1.29it/s]                                                 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 90/150 [01:20<00:46,  1.29it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 91/150 [01:21<00:45,  1.29it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 92/150 [01:22<00:44,  1.30it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 93/150 [01:23<00:43,  1.30it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 94/150 [01:23<00:43,  1.30it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 95/150 [01:24<00:42,  1.30it/s]                                                 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 95/150 [01:24<00:42,  1.30it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 96/150 [01:25<00:41,  1.30it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 97/150 [01:26<00:40,  1.30it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 98/150 [01:27<00:39,  1.30it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 99/150 [01:27<00:39,  1.30it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 100/150 [01:28<00:39,  1.26it/s]                                                  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 100/150 [01:28<00:39,  1.26it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 101/150 [01:32<01:30,  1.85s/it] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 102/150 [01:33<01:13,  1.54s/it] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 103/150 [01:34<01:02,  1.32s/it] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 104/150 [01:35<00:54,  1.17s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 105/150 [01:36<00:48,  1.07s/it]                                                  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 105/150 [01:36<00:48,  1.07s/it] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 106/150 [01:37<00:44,  1.00s/it] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 107/150 [01:37<00:40,  1.07it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 108/150 [01:38<00:37,  1.12it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 109/150 [01:39<00:35,  1.16it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 110/150 [01:40<00:33,  1.19it/s]                                                  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 110/150 [01:40<00:33,  1.19it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 111/150 [01:41<00:32,  1.22it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 112/150 [01:41<00:30,  1.23it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 113/150 [01:42<00:29,  1.24it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 114/150 [01:43<00:28,  1.25it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 115/150 [01:44<00:27,  1.25it/s]                                                  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 115/150 [01:44<00:27,  1.25it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 116/150 [01:44<00:27,  1.26it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 117/150 [01:45<00:26,  1.26it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 118/150 [01:46<00:25,  1.26it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 119/150 [01:47<00:24,  1.26it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 120/150 [01:48<00:23,  1.26it/s]                                                  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 120/150 [01:48<00:23,  1.26it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 121/150 [01:48<00:22,  1.26it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 122/150 [01:49<00:22,  1.26it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 123/150 [01:50<00:21,  1.26it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 124/150 [01:51<00:20,  1.27it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 125/150 [01:52<00:19,  1.27it/s]                                                  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 125/150 [01:52<00:19,  1.27it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 126/150 [01:52<00:18,  1.27it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 127/150 [01:53<00:18,  1.27it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 128/150 [01:54<00:17,  1.28it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 129/150 [01:55<00:16,  1.28it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 130/150 [01:56<00:15,  1.28it/s]                                                  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 130/150 [01:56<00:15,  1.28it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 131/150 [01:56<00:14,  1.28it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 132/150 [01:57<00:14,  1.28it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 133/150 [01:58<00:13,  1.28it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 134/150 [01:59<00:12,  1.28it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 135/150 [01:59<00:11,  1.28it/s]                                                  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 135/150 [01:59<00:11,  1.28it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 136/150 [02:00<00:10,  1.28it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 137/150 [02:01<00:09,  1.41it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 138/150 [02:02<00:08,  1.35it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 139/150 [02:02<00:08,  1.32it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 140/150 [02:03<00:07,  1.29it/s]                                                  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 140/150 [02:03<00:07,  1.29it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 141/150 [02:04<00:07,  1.26it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 142/150 [02:05<00:06,  1.24it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 143/150 [02:06<00:05,  1.23it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 144/150 [02:06<00:04,  1.25it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 145/150 [02:07<00:04,  1.22it/s]                                                  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 145/150 [02:07<00:04,  1.22it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 146/150 [02:08<00:03,  1.20it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 147/150 [02:09<00:02,  1.18it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 148/150 [02:10<00:01,  1.17it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 149/150 [02:11<00:00,  1.16it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150/150 [02:12<00:00,  1.15it/s]                                                 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150/150 [02:12<00:00,  1.15it/s]                                                 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150/150 [02:16<00:00,  1.15it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150/150 [02:16<00:00,  1.10it/s]
{'loss': 1472.0769, 'grad_norm': 1429.3956298828125, 'learning_rate': 9.666666666666667e-06, 'epoch': 0.04}
{'loss': 1348.3976, 'grad_norm': 1372.8575439453125, 'learning_rate': 9.333333333333334e-06, 'epoch': 0.07}
{'loss': 1322.9488, 'grad_norm': 1682.294921875, 'learning_rate': 9e-06, 'epoch': 0.11}
{'loss': 1334.4494, 'grad_norm': 1907.262939453125, 'learning_rate': 8.666666666666668e-06, 'epoch': 0.15}
{'loss': 1398.789, 'grad_norm': 2602.906982421875, 'learning_rate': 8.333333333333334e-06, 'epoch': 0.18}
{'loss': 1190.6912, 'grad_norm': 2208.644775390625, 'learning_rate': 8.000000000000001e-06, 'epoch': 0.22}
{'loss': 1340.6257, 'grad_norm': 2659.185302734375, 'learning_rate': 7.666666666666667e-06, 'epoch': 0.26}
{'loss': 1011.0411, 'grad_norm': 2342.78564453125, 'learning_rate': 7.333333333333333e-06, 'epoch': 0.29}
{'loss': 1121.5123, 'grad_norm': 2221.325439453125, 'learning_rate': 7e-06, 'epoch': 0.33}
{'loss': 1143.3401, 'grad_norm': 2579.575439453125, 'learning_rate': 6.666666666666667e-06, 'epoch': 0.37}
{'loss': 826.6501, 'grad_norm': 1521.25634765625, 'learning_rate': 6.333333333333333e-06, 'epoch': 0.4}
{'loss': 916.6369, 'grad_norm': 2503.697509765625, 'learning_rate': 6e-06, 'epoch': 0.44}
{'loss': 713.8579, 'grad_norm': 2226.010986328125, 'learning_rate': 5.666666666666667e-06, 'epoch': 0.48}
{'loss': 846.6725, 'grad_norm': 2594.394287109375, 'learning_rate': 5.333333333333334e-06, 'epoch': 0.51}
{'loss': 956.0934, 'grad_norm': 2877.731201171875, 'learning_rate': 5e-06, 'epoch': 0.55}
{'loss': 784.5223, 'grad_norm': 2352.980224609375, 'learning_rate': 4.666666666666667e-06, 'epoch': 0.59}
{'loss': 671.5954, 'grad_norm': 2392.781005859375, 'learning_rate': 4.333333333333334e-06, 'epoch': 0.62}
{'loss': 666.541, 'grad_norm': 2355.711669921875, 'learning_rate': 4.000000000000001e-06, 'epoch': 0.66}
{'loss': 478.0159, 'grad_norm': 2478.468505859375, 'learning_rate': 3.6666666666666666e-06, 'epoch': 0.7}
{'loss': 618.7125, 'grad_norm': 2756.78466796875, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.73}
{'loss': 608.9343, 'grad_norm': 4700.08935546875, 'learning_rate': 3e-06, 'epoch': 0.77}
{'loss': 564.6021, 'grad_norm': 3615.23095703125, 'learning_rate': 2.666666666666667e-06, 'epoch': 0.8}
{'loss': 477.4833, 'grad_norm': 3408.9814453125, 'learning_rate': 2.3333333333333336e-06, 'epoch': 0.84}
{'loss': 441.2477, 'grad_norm': 2701.968994140625, 'learning_rate': 2.0000000000000003e-06, 'epoch': 0.88}
{'loss': 385.5631, 'grad_norm': 3138.153564453125, 'learning_rate': 1.6666666666666667e-06, 'epoch': 0.91}
{'loss': 511.7935, 'grad_norm': 2634.618408203125, 'learning_rate': 1.3333333333333334e-06, 'epoch': 0.95}
{'loss': 382.1463, 'grad_norm': 3406.93408203125, 'learning_rate': 1.0000000000000002e-06, 'epoch': 0.99}
{'loss': 456.105, 'grad_norm': 3415.780029296875, 'learning_rate': 6.666666666666667e-07, 'epoch': 1.02}
{'loss': 303.4762, 'grad_norm': 2817.714599609375, 'learning_rate': 3.3333333333333335e-07, 'epoch': 1.06}
{'loss': 463.7074, 'grad_norm': 3732.911376953125, 'learning_rate': 0.0, 'epoch': 1.1}
{'train_runtime': 136.2006, 'train_samples_per_second': 3.304, 'train_steps_per_second': 1.101, 'train_loss': 825.2742911783854, 'epoch': 1.1}
Done. Model saved to model/forget_model/mixed_distill_epoch150_temp0.3_forgetAlpha0.5.
Running evaluation on model/forget_model/mixed_distill_epoch150_temp0.3_forgetAlpha0.5
Loading checkpoint from model/forget_model/mixed_distill_epoch150_temp0.3_forgetAlpha0.5
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 1/3 [00:01<00:03,  1.82s/it]Loading checkpoint shards:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:03<00:01,  1.64s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:04<00:00,  1.43s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:04<00:00,  1.50s/it]
Working on eval task eval_log with split retain_perturbed
  0%|          | 0/14 [00:00<?, ?it/s]/student/tahmad8/anaconda3/envs/tofu39/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:626: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/student/tahmad8/anaconda3/envs/tofu39/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:631: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
  7%|â–‹         | 1/14 [00:25<05:34, 25.73s/it] 14%|â–ˆâ–        | 2/14 [00:59<06:02, 30.21s/it] 21%|â–ˆâ–ˆâ–       | 3/14 [01:42<06:41, 36.46s/it] 29%|â–ˆâ–ˆâ–Š       | 4/14 [02:20<06:07, 36.74s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 5/14 [02:57<05:31, 36.87s/it] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 6/14 [03:40<05:12, 39.07s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 7/14 [04:20<04:35, 39.40s/it] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 8/14 [04:54<03:46, 37.69s/it] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 9/14 [05:39<03:19, 39.94s/it] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 10/14 [06:17<02:37, 39.41s/it] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 11/14 [06:55<01:56, 38.78s/it] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 12/14 [07:38<01:20, 40.06s/it] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 13/14 [08:19<00:40, 40.30s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 14/14 [08:39<00:00, 34.30s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 14/14 [08:39<00:00, 37.10s/it]
[2025-04-07 01:28:09,681][absl][INFO] - Using default tokenizer.
0it [00:00, ?it/s]1it [00:05,  5.91s/it]2it [00:11,  5.89s/it]3it [00:17,  5.63s/it]4it [00:22,  5.54s/it]5it [00:29,  5.96s/it]6it [00:33,  5.52s/it]7it [00:40,  5.83s/it]8it [00:49,  6.77s/it]9it [00:57,  7.13s/it]10it [01:03,  6.92s/it]11it [01:09,  6.60s/it]12it [01:15,  6.37s/it]13it [01:21,  6.38s/it]14it [01:28,  6.43s/it]15it [01:33,  6.09s/it]16it [01:39,  6.10s/it]17it [01:45,  5.94s/it]18it [01:50,  5.86s/it]19it [01:56,  5.86s/it]20it [02:02,  5.86s/it]21it [02:08,  5.89s/it]22it [02:13,  5.58s/it]23it [02:22,  6.51s/it]24it [02:27,  6.20s/it]25it [02:34,  6.51s/it]26it [02:41,  6.72s/it]27it [02:48,  6.65s/it]28it [02:53,  6.22s/it]29it [02:59,  6.07s/it]30it [03:05,  5.98s/it]31it [03:10,  5.89s/it]32it [03:16,  5.88s/it]33it [03:23,  6.01s/it]34it [03:30,  6.54s/it]35it [03:37,  6.64s/it]36it [03:44,  6.70s/it]37it [03:50,  6.55s/it]38it [03:55,  6.07s/it]39it [04:02,  6.28s/it]40it [04:09,  6.42s/it]41it [04:15,  6.33s/it]42it [04:20,  5.98s/it]43it [04:26,  6.13s/it]44it [04:32,  5.97s/it]45it [04:38,  6.02s/it]46it [04:44,  6.05s/it]47it [04:51,  6.14s/it]48it [04:55,  5.68s/it]49it [05:03,  6.42s/it]50it [05:12,  7.05s/it]51it [05:19,  7.11s/it]52it [05:26,  6.91s/it]53it [05:31,  6.59s/it]54it [05:37,  6.37s/it]55it [05:44,  6.55s/it]56it [05:49,  6.06s/it]57it [05:55,  5.94s/it]58it [05:56,  4.42s/it]58it [05:56,  6.14s/it]
Working on eval task eval_log_forget with split forget10_perturbed
  0%|          | 0/14 [00:00<?, ?it/s]  7%|â–‹         | 1/14 [00:34<07:33, 34.86s/it] 14%|â–ˆâ–        | 2/14 [01:21<08:21, 41.77s/it] 21%|â–ˆâ–ˆâ–       | 3/14 [01:59<07:22, 40.20s/it] 29%|â–ˆâ–ˆâ–Š       | 4/14 [02:40<06:44, 40.48s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 5/14 [03:18<05:55, 39.52s/it] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 6/14 [03:56<05:11, 38.94s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 7/14 [04:35<04:33, 39.14s/it] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 8/14 [05:18<04:01, 40.33s/it] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 9/14 [05:55<03:16, 39.30s/it] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 10/14 [06:33<02:34, 38.68s/it] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 11/14 [07:13<01:57, 39.28s/it] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 12/14 [07:53<01:19, 39.52s/it] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 13/14 [08:34<00:39, 39.81s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 14/14 [08:58<00:00, 35.01s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 14/14 [08:58<00:00, 38.44s/it]
[2025-04-07 01:43:09,134][absl][INFO] - Using default tokenizer.
0it [00:00, ?it/s]1it [00:05,  5.49s/it]2it [00:11,  5.50s/it]3it [00:17,  5.79s/it]4it [00:23,  5.91s/it]5it [00:28,  5.67s/it]6it [00:37,  6.69s/it]7it [00:41,  5.99s/it]8it [00:47,  5.99s/it]9it [00:53,  5.99s/it]10it [01:02,  6.75s/it]11it [01:07,  6.21s/it]12it [01:13,  6.22s/it]13it [01:19,  6.08s/it]14it [01:25,  6.17s/it]15it [01:31,  5.99s/it]16it [01:37,  6.09s/it]17it [01:43,  6.13s/it]18it [01:49,  6.16s/it]19it [01:55,  6.00s/it]20it [02:02,  6.43s/it]21it [02:10,  6.71s/it]22it [02:16,  6.69s/it]23it [02:21,  6.21s/it]24it [02:27,  6.06s/it]25it [02:33,  6.03s/it]26it [02:41,  6.53s/it]27it [02:49,  7.05s/it]28it [02:56,  6.93s/it]29it [03:02,  6.68s/it]30it [03:07,  6.11s/it]31it [03:13,  6.11s/it]32it [03:19,  6.09s/it]33it [03:25,  6.09s/it]34it [03:31,  6.08s/it]35it [03:33,  4.89s/it]36it [03:42,  6.08s/it]37it [03:51,  6.95s/it]38it [03:59,  7.42s/it]39it [04:06,  7.27s/it]40it [04:11,  6.54s/it]41it [04:17,  6.33s/it]42it [04:23,  6.10s/it]43it [04:32,  6.97s/it]44it [04:36,  6.28s/it]45it [04:42,  6.09s/it]46it [04:48,  6.18s/it]47it [04:56,  6.69s/it]48it [05:03,  6.79s/it]49it [05:10,  6.86s/it]50it [05:18,  7.00s/it]51it [05:24,  6.77s/it]52it [05:28,  6.07s/it]53it [05:34,  5.98s/it]54it [05:41,  6.42s/it]55it [05:48,  6.50s/it]56it [05:55,  6.58s/it]57it [06:00,  6.14s/it]58it [06:01,  4.56s/it]58it [06:01,  6.23s/it]
Done with 3/18: model/forget_model/mixed_distill_epoch150_temp0.3_forgetAlpha0.5
--------------------------------------------------

[4/18] Running distillation: epoch=70,, temp=0.3, alpha=0.7
Saving to: model/forget_model/mixed_distill_epoch70,_temp0.3_forgetAlpha0.7
usage: mixed_distill.py [-h] [--temperature TEMPERATURE]
                        [--forget_loss_alpha FORGET_LOSS_ALPHA]
                        [--epochs EPOCHS] --output_dir OUTPUT_DIR
mixed_distill.py: error: argument --epochs: invalid int value: '70,'
Running evaluation on model/forget_model/mixed_distill_epoch70,_temp0.3_forgetAlpha0.7
Ambiguous value for argument 'model_path=model/forget_model/mixed_distill_epoch70,_temp0.3_forgetAlpha0.7'
1. To use it as a list, use key=[value1,value2]
2. To use it as string, quote the value: key=\'value1,value2\'
3. To sweep over it, add --multirun to your command line

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Done with 4/18: model/forget_model/mixed_distill_epoch70,_temp0.3_forgetAlpha0.7
--------------------------------------------------

[5/18] Running distillation: epoch=100,, temp=0.3, alpha=0.7
Saving to: model/forget_model/mixed_distill_epoch100,_temp0.3_forgetAlpha0.7
usage: mixed_distill.py [-h] [--temperature TEMPERATURE]
                        [--forget_loss_alpha FORGET_LOSS_ALPHA]
                        [--epochs EPOCHS] --output_dir OUTPUT_DIR
mixed_distill.py: error: argument --epochs: invalid int value: '100,'
Running evaluation on model/forget_model/mixed_distill_epoch100,_temp0.3_forgetAlpha0.7
Ambiguous value for argument 'model_path=model/forget_model/mixed_distill_epoch100,_temp0.3_forgetAlpha0.7'
1. To use it as a list, use key=[value1,value2]
2. To use it as string, quote the value: key=\'value1,value2\'
3. To sweep over it, add --multirun to your command line

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Done with 5/18: model/forget_model/mixed_distill_epoch100,_temp0.3_forgetAlpha0.7
--------------------------------------------------

[6/18] Running distillation: epoch=150, temp=0.3, alpha=0.7
Saving to: model/forget_model/mixed_distill_epoch150_temp0.3_forgetAlpha0.7
The model was loaded with use_flash_attention_2=True, which is deprecated and may be removed in a future release. Please use `attn_implementation="flash_attention_2"` instead.
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 1/3 [00:01<00:03,  1.55s/it]Loading checkpoint shards:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:03<00:01,  1.55s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:04<00:00,  1.40s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:04<00:00,  1.44s/it]
/student/tahmad8/anaconda3/envs/tofu39/lib/python3.9/site-packages/transformers/training_args.py:1576: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
[2025-04-07 01:49:56,930] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Warning: The cache directory for DeepSpeed Triton autotune, /student/tahmad8/.triton/autotune, appears to be on an NFS system. While this is generally acceptable, if you experience slowdowns or hanging when DeepSpeed exits, it is recommended to set the TRITON_CACHE_DIR environment variable to a non-NFS path.
  0%|          | 0/150 [00:00<?, ?it/s]  1%|          | 1/150 [00:01<03:43,  1.50s/it]  1%|â–         | 2/150 [00:02<02:37,  1.06s/it]  2%|â–         | 3/150 [00:03<02:15,  1.09it/s]  3%|â–Ž         | 4/150 [00:03<02:04,  1.17it/s]  3%|â–Ž         | 5/150 [00:04<01:58,  1.22it/s]                                                 3%|â–Ž         | 5/150 [00:04<01:58,  1.22it/s]  4%|â–         | 6/150 [00:05<01:55,  1.25it/s]  5%|â–         | 7/150 [00:06<01:54,  1.25it/s]  5%|â–Œ         | 8/150 [00:06<01:53,  1.25it/s]  6%|â–Œ         | 9/150 [00:07<01:54,  1.23it/s]  7%|â–‹         | 10/150 [00:08<01:54,  1.22it/s]                                                  7%|â–‹         | 10/150 [00:08<01:54,  1.22it/s]  7%|â–‹         | 11/150 [00:09<01:55,  1.21it/s]  8%|â–Š         | 12/150 [00:10<01:56,  1.19it/s]  9%|â–Š         | 13/150 [00:11<01:52,  1.22it/s]  9%|â–‰         | 14/150 [00:11<01:54,  1.19it/s] 10%|â–ˆ         | 15/150 [00:12<01:59,  1.13it/s]                                                 10%|â–ˆ         | 15/150 [00:12<01:59,  1.13it/s] 11%|â–ˆ         | 16/150 [00:13<02:01,  1.10it/s] 11%|â–ˆâ–        | 17/150 [00:14<02:03,  1.08it/s] 12%|â–ˆâ–        | 18/150 [00:15<02:04,  1.06it/s] 13%|â–ˆâ–Ž        | 19/150 [00:16<02:04,  1.05it/s] 13%|â–ˆâ–Ž        | 20/150 [00:17<02:04,  1.05it/s]                                                 13%|â–ˆâ–Ž        | 20/150 [00:17<02:04,  1.05it/s] 14%|â–ˆâ–        | 21/150 [00:18<02:04,  1.04it/s] 15%|â–ˆâ–        | 22/150 [00:19<02:03,  1.04it/s] 15%|â–ˆâ–Œ        | 23/150 [00:20<02:02,  1.04it/s] 16%|â–ˆâ–Œ        | 24/150 [00:21<02:01,  1.04it/s] 17%|â–ˆâ–‹        | 25/150 [00:22<02:00,  1.03it/s]                                                 17%|â–ˆâ–‹        | 25/150 [00:22<02:00,  1.03it/s] 17%|â–ˆâ–‹        | 26/150 [00:23<02:00,  1.03it/s] 18%|â–ˆâ–Š        | 27/150 [00:24<02:00,  1.02it/s] 19%|â–ˆâ–Š        | 28/150 [00:25<02:01,  1.00it/s] 19%|â–ˆâ–‰        | 29/150 [00:26<01:54,  1.06it/s] 20%|â–ˆâ–ˆ        | 30/150 [00:27<01:48,  1.11it/s]                                                 20%|â–ˆâ–ˆ        | 30/150 [00:27<01:48,  1.11it/s] 21%|â–ˆâ–ˆ        | 31/150 [00:28<01:50,  1.08it/s] 21%|â–ˆâ–ˆâ–       | 32/150 [00:29<01:58,  1.00s/it] 22%|â–ˆâ–ˆâ–       | 33/150 [00:30<02:02,  1.05s/it] 23%|â–ˆâ–ˆâ–Ž       | 34/150 [00:31<02:05,  1.09s/it] 23%|â–ˆâ–ˆâ–Ž       | 35/150 [00:32<02:08,  1.11s/it]                                                 23%|â–ˆâ–ˆâ–Ž       | 35/150 [00:32<02:08,  1.11s/it] 24%|â–ˆâ–ˆâ–       | 36/150 [00:34<02:09,  1.13s/it] 25%|â–ˆâ–ˆâ–       | 37/150 [00:35<02:09,  1.14s/it] 25%|â–ˆâ–ˆâ–Œ       | 38/150 [00:36<02:09,  1.15s/it] 26%|â–ˆâ–ˆâ–Œ       | 39/150 [00:37<02:08,  1.16s/it] 27%|â–ˆâ–ˆâ–‹       | 40/150 [00:38<02:07,  1.16s/it]                                                 27%|â–ˆâ–ˆâ–‹       | 40/150 [00:38<02:07,  1.16s/it] 27%|â–ˆâ–ˆâ–‹       | 41/150 [00:39<02:07,  1.17s/it] 28%|â–ˆâ–ˆâ–Š       | 42/150 [00:41<02:06,  1.17s/it] 29%|â–ˆâ–ˆâ–Š       | 43/150 [00:42<02:05,  1.17s/it] 29%|â–ˆâ–ˆâ–‰       | 44/150 [00:43<02:04,  1.17s/it] 30%|â–ˆâ–ˆâ–ˆ       | 45/150 [00:44<02:02,  1.16s/it]                                                 30%|â–ˆâ–ˆâ–ˆ       | 45/150 [00:44<02:02,  1.16s/it] 31%|â–ˆâ–ˆâ–ˆ       | 46/150 [00:45<02:00,  1.16s/it] 31%|â–ˆâ–ˆâ–ˆâ–      | 47/150 [00:46<01:59,  1.16s/it] 32%|â–ˆâ–ˆâ–ˆâ–      | 48/150 [00:48<01:58,  1.16s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 49/150 [00:49<01:57,  1.16s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 50/150 [00:50<01:55,  1.16s/it]                                                 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 50/150 [00:50<01:55,  1.16s/it] 34%|â–ˆâ–ˆâ–ˆâ–      | 51/150 [00:54<03:26,  2.09s/it] 35%|â–ˆâ–ˆâ–ˆâ–      | 52/150 [00:55<02:53,  1.77s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 53/150 [00:56<02:30,  1.55s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 54/150 [00:57<02:14,  1.40s/it] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 55/150 [00:58<02:02,  1.29s/it]                                                 37%|â–ˆâ–ˆâ–ˆâ–‹      | 55/150 [00:58<02:02,  1.29s/it] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 56/150 [00:59<01:54,  1.21s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 57/150 [01:00<01:48,  1.16s/it] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 58/150 [01:01<01:44,  1.13s/it] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 59/150 [01:03<01:40,  1.11s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 60/150 [01:04<01:38,  1.09s/it]                                                 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 60/150 [01:04<01:38,  1.09s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 61/150 [01:05<01:36,  1.08s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 62/150 [01:06<01:34,  1.08s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 63/150 [01:07<01:33,  1.07s/it] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 64/150 [01:08<01:31,  1.06s/it] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 65/150 [01:09<01:30,  1.06s/it]                                                 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 65/150 [01:09<01:30,  1.06s/it] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 66/150 [01:10<01:28,  1.06s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 67/150 [01:11<01:27,  1.05s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 68/150 [01:12<01:26,  1.06s/it] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 69/150 [01:13<01:25,  1.06s/it] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 70/150 [01:14<01:24,  1.06s/it]                                                 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 70/150 [01:14<01:24,  1.06s/it] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 71/150 [01:15<01:23,  1.06s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 72/150 [01:16<01:22,  1.06s/it] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 73/150 [01:17<01:21,  1.06s/it] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 74/150 [01:18<01:20,  1.06s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 75/150 [01:19<01:19,  1.06s/it]                                                 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 75/150 [01:19<01:19,  1.06s/it] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 76/150 [01:21<01:18,  1.06s/it] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 77/150 [01:22<01:17,  1.06s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 78/150 [01:23<01:16,  1.06s/it] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 79/150 [01:24<01:15,  1.06s/it] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 80/150 [01:25<01:13,  1.06s/it]                                                 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 80/150 [01:25<01:13,  1.06s/it] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 81/150 [01:26<01:12,  1.05s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 82/150 [01:27<01:11,  1.06s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 83/150 [01:28<01:10,  1.06s/it] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 84/150 [01:29<01:09,  1.06s/it] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 85/150 [01:30<01:08,  1.05s/it]                                                 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 85/150 [01:30<01:08,  1.05s/it] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 86/150 [01:31<01:07,  1.05s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 87/150 [01:32<01:06,  1.05s/it] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 88/150 [01:33<01:05,  1.05s/it] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 89/150 [01:34<01:04,  1.05s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 90/150 [01:35<01:03,  1.06s/it]                                                 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 90/150 [01:35<01:03,  1.06s/it] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 91/150 [01:36<01:02,  1.06s/it] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 92/150 [01:37<01:01,  1.06s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 93/150 [01:38<01:00,  1.05s/it] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 94/150 [01:40<00:59,  1.06s/it] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 95/150 [01:41<00:57,  1.05s/it]                                                 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 95/150 [01:41<00:57,  1.05s/it] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 96/150 [01:42<00:56,  1.05s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 97/150 [01:43<00:55,  1.05s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 98/150 [01:44<00:54,  1.05s/it] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 99/150 [01:45<00:53,  1.05s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 100/150 [01:46<00:52,  1.05s/it]                                                  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 100/150 [01:46<00:52,  1.05s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 101/150 [01:50<01:41,  2.07s/it] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 102/150 [01:51<01:24,  1.77s/it] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 103/150 [01:52<01:12,  1.55s/it] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 104/150 [01:53<01:04,  1.40s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 105/150 [01:54<00:58,  1.30s/it]                                                  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 105/150 [01:54<00:58,  1.30s/it] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 106/150 [01:56<00:53,  1.22s/it] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 107/150 [01:57<00:50,  1.17s/it] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 108/150 [01:58<00:47,  1.14s/it] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 109/150 [01:59<00:45,  1.11s/it] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 110/150 [02:00<00:43,  1.10s/it]                                                  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 110/150 [02:00<00:43,  1.10s/it] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 111/150 [02:01<00:42,  1.08s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 112/150 [02:02<00:40,  1.07s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 113/150 [02:03<00:39,  1.07s/it] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 114/150 [02:04<00:38,  1.06s/it] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 115/150 [02:05<00:37,  1.06s/it]                                                  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 115/150 [02:05<00:37,  1.06s/it] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 116/150 [02:06<00:35,  1.06s/it] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 117/150 [02:07<00:34,  1.05s/it] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 118/150 [02:08<00:33,  1.05s/it] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 119/150 [02:09<00:32,  1.05s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 120/150 [02:10<00:31,  1.05s/it]                                                  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 120/150 [02:10<00:31,  1.05s/it] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 121/150 [02:11<00:30,  1.05s/it] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 122/150 [02:12<00:29,  1.05s/it] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 123/150 [02:13<00:28,  1.05s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 124/150 [02:14<00:27,  1.05s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 125/150 [02:15<00:26,  1.05s/it]                                                  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 125/150 [02:15<00:26,  1.05s/it] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 126/150 [02:17<00:25,  1.04s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 127/150 [02:18<00:24,  1.04s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 128/150 [02:19<00:23,  1.05s/it] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 129/150 [02:20<00:21,  1.05s/it] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 130/150 [02:21<00:20,  1.04s/it]                                                  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 130/150 [02:21<00:20,  1.04s/it] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 131/150 [02:22<00:19,  1.04s/it] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 132/150 [02:23<00:18,  1.05s/it] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 133/150 [02:24<00:17,  1.05s/it] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 134/150 [02:25<00:16,  1.05s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 135/150 [02:26<00:15,  1.05s/it]                                                  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 135/150 [02:26<00:15,  1.05s/it] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 136/150 [02:27<00:14,  1.05s/it] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 137/150 [02:28<00:12,  1.05it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 138/150 [02:29<00:11,  1.02it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 139/150 [02:30<00:11,  1.00s/it] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 140/150 [02:31<00:10,  1.01s/it]                                                  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 140/150 [02:31<00:10,  1.01s/it] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 141/150 [02:32<00:09,  1.03s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 142/150 [02:33<00:08,  1.04s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 143/150 [02:34<00:07,  1.04s/it] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 144/150 [02:35<00:06,  1.05s/it] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 145/150 [02:36<00:05,  1.05s/it]                                                  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 145/150 [02:36<00:05,  1.05s/it] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 146/150 [02:37<00:04,  1.06s/it] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 147/150 [02:38<00:03,  1.06s/it] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 148/150 [02:39<00:02,  1.06s/it] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 149/150 [02:40<00:01,  1.06s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150/150 [02:41<00:00,  1.06s/it]                                                 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150/150 [02:41<00:00,  1.06s/it]                                                 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150/150 [02:46<00:00,  1.06s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150/150 [02:46<00:00,  1.11s/it]
{'loss': 2059.8877, 'grad_norm': 2060.163818359375, 'learning_rate': 9.666666666666667e-06, 'epoch': 0.04}
{'loss': 1889.5512, 'grad_norm': 1964.5133056640625, 'learning_rate': 9.333333333333334e-06, 'epoch': 0.07}
{'loss': 1855.1172, 'grad_norm': 2391.083740234375, 'learning_rate': 9e-06, 'epoch': 0.11}
{'loss': 1872.7881, 'grad_norm': 2728.97021484375, 'learning_rate': 8.666666666666668e-06, 'epoch': 0.15}
{'loss': 1961.8598, 'grad_norm': 3678.2734375, 'learning_rate': 8.333333333333334e-06, 'epoch': 0.18}
{'loss': 1674.2662, 'grad_norm': 3107.113525390625, 'learning_rate': 8.000000000000001e-06, 'epoch': 0.22}
{'loss': 1889.8332, 'grad_norm': 3758.2265625, 'learning_rate': 7.666666666666667e-06, 'epoch': 0.26}
{'loss': 1421.8043, 'grad_norm': 3458.38525390625, 'learning_rate': 7.333333333333333e-06, 'epoch': 0.29}
{'loss': 1584.9213, 'grad_norm': 3084.39013671875, 'learning_rate': 7e-06, 'epoch': 0.33}
{'loss': 1616.9299, 'grad_norm': 3676.66259765625, 'learning_rate': 6.666666666666667e-06, 'epoch': 0.37}
{'loss': 1163.6213, 'grad_norm': 2094.921875, 'learning_rate': 6.333333333333333e-06, 'epoch': 0.4}
{'loss': 1296.5232, 'grad_norm': 3484.594482421875, 'learning_rate': 6e-06, 'epoch': 0.44}
{'loss': 1006.2137, 'grad_norm': 3121.817626953125, 'learning_rate': 5.666666666666667e-06, 'epoch': 0.48}
{'loss': 1197.2164, 'grad_norm': 3607.623291015625, 'learning_rate': 5.333333333333334e-06, 'epoch': 0.51}
{'loss': 1354.0547, 'grad_norm': 3987.314453125, 'learning_rate': 5e-06, 'epoch': 0.55}
{'loss': 1105.6412, 'grad_norm': 3290.922607421875, 'learning_rate': 4.666666666666667e-06, 'epoch': 0.59}
{'loss': 951.3029, 'grad_norm': 3285.484130859375, 'learning_rate': 4.333333333333334e-06, 'epoch': 0.62}
{'loss': 942.0639, 'grad_norm': 3305.73974609375, 'learning_rate': 4.000000000000001e-06, 'epoch': 0.66}
{'loss': 676.6093, 'grad_norm': 3402.50634765625, 'learning_rate': 3.6666666666666666e-06, 'epoch': 0.7}
{'loss': 888.4603, 'grad_norm': 3820.893798828125, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.73}
{'loss': 864.361, 'grad_norm': 6683.6513671875, 'learning_rate': 3e-06, 'epoch': 0.77}
{'loss': 809.2411, 'grad_norm': 5040.81298828125, 'learning_rate': 2.666666666666667e-06, 'epoch': 0.8}
{'loss': 682.6695, 'grad_norm': 4847.86962890625, 'learning_rate': 2.3333333333333336e-06, 'epoch': 0.84}
{'loss': 634.8233, 'grad_norm': 3890.557373046875, 'learning_rate': 2.0000000000000003e-06, 'epoch': 0.88}
{'loss': 559.0116, 'grad_norm': 4447.60986328125, 'learning_rate': 1.6666666666666667e-06, 'epoch': 0.91}
{'loss': 733.8849, 'grad_norm': 3683.088134765625, 'learning_rate': 1.3333333333333334e-06, 'epoch': 0.95}
{'loss': 554.9175, 'grad_norm': 4832.42041015625, 'learning_rate': 1.0000000000000002e-06, 'epoch': 0.99}
{'loss': 656.1978, 'grad_norm': 4800.50244140625, 'learning_rate': 6.666666666666667e-07, 'epoch': 1.02}
{'loss': 439.1317, 'grad_norm': 4148.2109375, 'learning_rate': 3.3333333333333335e-07, 'epoch': 1.06}
{'loss': 664.6682, 'grad_norm': 5285.5302734375, 'learning_rate': 0.0, 'epoch': 1.1}
{'train_runtime': 166.1312, 'train_samples_per_second': 2.709, 'train_steps_per_second': 0.903, 'train_loss': 1166.919080403646, 'epoch': 1.1}
Done. Model saved to model/forget_model/mixed_distill_epoch150_temp0.3_forgetAlpha0.7.
Running evaluation on model/forget_model/mixed_distill_epoch150_temp0.3_forgetAlpha0.7
Loading checkpoint from model/forget_model/mixed_distill_epoch150_temp0.3_forgetAlpha0.7
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 1/3 [00:07<00:15,  7.58s/it]Loading checkpoint shards:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:28<00:15, 15.33s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:29<00:00,  8.81s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:29<00:00,  9.80s/it]
Working on eval task eval_log with split retain_perturbed
  0%|          | 0/14 [00:00<?, ?it/s]/student/tahmad8/anaconda3/envs/tofu39/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:626: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/student/tahmad8/anaconda3/envs/tofu39/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:631: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
  7%|â–‹         | 1/14 [00:28<06:06, 28.23s/it] 14%|â–ˆâ–        | 2/14 [01:03<06:27, 32.30s/it] 21%|â–ˆâ–ˆâ–       | 3/14 [01:47<06:55, 37.77s/it] 29%|â–ˆâ–ˆâ–Š       | 4/14 [02:28<06:29, 38.98s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 5/14 [03:05<05:44, 38.28s/it] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 6/14 [03:42<05:03, 37.89s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 7/14 [04:29<04:46, 40.93s/it] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 8/14 [05:07<03:58, 39.79s/it] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 9/14 [05:53<03:28, 41.71s/it] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 10/14 [06:31<02:42, 40.58s/it] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 11/14 [07:08<01:59, 39.72s/it] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 12/14 [07:56<01:24, 42.21s/it] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 13/14 [08:32<00:40, 40.10s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 14/14 [08:59<00:00, 36.28s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 14/14 [08:59<00:00, 38.54s/it]
[2025-04-07 02:05:00,332][absl][INFO] - Using default tokenizer.
0it [00:00, ?it/s]1it [00:06,  6.36s/it]2it [00:12,  6.38s/it]3it [00:19,  6.37s/it]4it [00:25,  6.36s/it]5it [00:31,  6.36s/it]6it [00:38,  6.34s/it]7it [00:44,  6.34s/it]8it [00:50,  6.35s/it]9it [00:57,  6.34s/it]10it [01:03,  6.34s/it]11it [01:09,  6.34s/it]12it [01:16,  6.34s/it]13it [01:22,  6.36s/it]14it [01:28,  6.36s/it]15it [01:35,  6.36s/it]16it [01:41,  6.38s/it]17it [01:48,  6.38s/it]18it [01:54,  6.36s/it]19it [02:03,  7.07s/it]20it [02:11,  7.49s/it]21it [02:18,  7.37s/it]22it [02:25,  7.08s/it]23it [02:31,  6.88s/it]24it [02:35,  6.07s/it]25it [02:41,  6.11s/it]26it [02:47,  5.91s/it]27it [02:53,  6.01s/it]28it [02:59,  6.06s/it]29it [03:05,  5.82s/it]30it [03:13,  6.51s/it]31it [03:20,  6.72s/it]32it [03:26,  6.67s/it]33it [03:33,  6.64s/it]34it [03:40,  6.63s/it]35it [03:46,  6.42s/it]36it [03:51,  6.00s/it]37it [03:56,  5.92s/it]38it [04:02,  5.89s/it]39it [04:10,  6.60s/it]40it [04:14,  5.72s/it]41it [04:21,  6.16s/it]42it [04:26,  5.87s/it]43it [04:34,  6.46s/it]44it [04:42,  6.86s/it]45it [04:49,  6.86s/it]46it [04:56,  6.86s/it]47it [05:02,  6.66s/it]48it [05:07,  6.16s/it]49it [05:12,  5.96s/it]50it [05:18,  5.92s/it]51it [05:25,  6.32s/it]52it [05:31,  6.04s/it]53it [05:38,  6.42s/it]54it [05:44,  6.12s/it]55it [05:51,  6.44s/it]56it [05:58,  6.66s/it]57it [06:05,  6.80s/it]58it [06:06,  5.05s/it]58it [06:06,  6.32s/it]
Working on eval task eval_log_forget with split forget10_perturbed
  0%|          | 0/14 [00:00<?, ?it/s]  7%|â–‹         | 1/14 [00:38<08:18, 38.36s/it] 14%|â–ˆâ–        | 2/14 [01:16<07:40, 38.40s/it] 21%|â–ˆâ–ˆâ–       | 3/14 [01:54<06:56, 37.91s/it] 29%|â–ˆâ–ˆâ–Š       | 4/14 [02:39<06:49, 40.93s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 5/14 [03:18<06:00, 40.06s/it] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 6/14 [03:56<05:16, 39.53s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 7/14 [04:35<04:35, 39.32s/it] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 8/14 [05:19<04:04, 40.81s/it]